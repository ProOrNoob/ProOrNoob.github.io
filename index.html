<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Sutta Reader</title>

  <!-- FIX: Add font imports for Noto Serif and Cinzel -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,400;0,600;0,700;0,800;1,400&family=Cinzel:wght@500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- FIX: Added missing .app wrapper that CSS expects -->
<div class="app">
  <div class="card" id="card">

    <!-- TOP NOTE -->
    <div class="top-note" role="note">
      <span class="top-note-text">NAMO TASSA BHAGAVATO ARAHATO SAMMƒÄSAMBUDDHASSA</span>
      <div class="top-note-actions"></div>
    </div>

    <!-- HEADER -->
    <div class="header" role="banner">
      <h1 id="title">Ch∆∞a ch·ªçn b√†i</h1>
      <div id="subtitle" aria-live="polite">‚Äî</div>
    </div>

    <!-- N·ªòI DUNG KINH -->
    <div id="sutraGrid" role="main" aria-live="polite" aria-busy="false"></div>

    <!-- NAV BAR -->
    <div class="nav-bar">
      <button id="btnPrev" class="nav-btn" disabled aria-label="B√†i tr∆∞·ªõc">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
             stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"
             role="presentation" aria-hidden="true">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <div id="navTitle" class="nav-title">‚Äî</div>
      <button id="btnNext" class="nav-btn" disabled aria-label="B√†i ti·∫øp theo">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
             stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"
             role="presentation" aria-hidden="true">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <!-- BACK TO TOP -->
    <button id="btnBackTop" aria-label="L√™n ƒë·∫ßu trang">‚Üë</button>

    <!-- N√öT M·ªû SIDEBAR -->
    <button type="button" id="sidebar-btn" title="Open sutta list" aria-label="M·ªü danh m·ª•c b√†i kinh">
      <span class="sidebar-label" data-i18n="btn-library">Library</span>
      <span class="sidebar-arrow" aria-hidden="true">‚ñ∏</span>
    </button>

    <!-- PANEL DANH M·ª§C KINH -->
    <!-- FIX: Removed aria-modal="false" (misleading for non-modal panel) -->
    <div id="sutraMenuPanel" class="panel" role="dialog"
         aria-label="Danh m·ª•c b√†i kinh" aria-hidden="true" inert>

      <div class="search-box">
        <input id="sutraSearch" type="search"
               placeholder="Nh·∫≠p t√™n b√†i kinh c·∫ßn t√¨m..."
               aria-label="T√¨m ki·∫øm b√†i kinh" autocomplete="off">
      </div>
      <div id="sutraSearchResults" class="search-results" role="listbox" aria-label="K·∫øt qu·∫£ t√¨m ki·∫øm"></div>
      <ul id="sutraMenuList" class="sutra-list" role="tree" aria-label="M·ª•c l·ª•c b√†i kinh"></ul>

      <!-- Toolbar -->
      <div class="panel-toolbar">
        <div class="toolbar-group">
          <button id="btnSettings" class="toolbar-btn"
                  aria-label="C√†i ƒë·∫∑t hi·ªÉn th·ªã" aria-haspopup="true" aria-expanded="false">
            <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor"
                 stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"
                 role="presentation" aria-hidden="true">
              <circle cx="12" cy="12" r="4"></circle>
              <path d="M12 3v2"></path><path d="M18.364 5.636 16.95 7.05"></path>
              <path d="M21 12h-2"></path><path d="M18.364 18.364 16.95 16.95"></path>
              <path d="M12 21v-2"></path><path d="M5.636 18.364 7.05 16.95"></path>
              <path d="M3 12h2"></path><path d="M5.636 5.636 7.05 7.05"></path>
            </svg>
          </button>
          <!-- FIX: Added aria-label fallback text for when SVG doesn't render -->
          <button id="btnUiLang" class="toolbar-btn btn-flag" aria-label="ƒê·ªïi ng√¥n ng·ªØ giao di·ªán">
            <span class="sr-only" style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0)">Ng√¥n ng·ªØ</span>
          </button>
          <button id="btnGuide" class="toolbar-btn" aria-label="H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor"
                 stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"
                 role="presentation" aria-hidden="true">
              <circle cx="12" cy="12" r="9"></circle>
              <path d="M9.5 9a2.5 2.5 0 0 1 5 0c0 1.4-.9 2-1.6 2.4-.7.4-1.1.7-1.1 1.6v.4"></path>
              <path d="M12 16.2h.01"></path>
            </svg>
          </button>

          <button class="toolbar-btn btn-dark-toggle" id="btnDarkMode"
                  title="Ch·∫ø ƒë·ªô t·ªëi" aria-label="Chuy·ªÉn s√°ng/t·ªëi">üåô</button>
        </div>
      </div>

    </div><!-- /#sutraMenuPanel -->

    <!-- SETTINGS PANEL ‚Äî n·∫±m ngo√†i sutraMenuPanel ƒë·ªÉ tr√°nh b·ªã inert block -->
    <div id="settingsPanel" class="panel" aria-hidden="true" inert>
      <div class="set-panel-header">
        <div class="panel-title" id="settingsTitle">Tu·ª≥ ch·ªânh</div>
      </div>
      <div class="set-panel-body">

        <!-- ‚ë† NG√îN NG·ªÆ -->
        <div class="set-sec">
          <div class="set-sec-hd">
            <span class="set-sec-title" id="settingsLangLabel">Ng√¥n ng·ªØ</span>
            <span class="set-sec-sub" id="settingsLangSub">Hi·ªán / ·∫©n c·ªôt</span>
          </div>
          <div class="set-sec-body">
            <div class="set-pills cols-3">
              <button class="pill active" id="btnPali" aria-pressed="true">PƒÅli</button>
              <button class="pill active" id="btnEng"  aria-pressed="true">English</button>
              <button class="pill active" id="btnVie"  aria-pressed="true">Vi·ªát</button>
            </div>
          </div>
        </div>

        <!-- ‚ë° B·ªê C·ª§C -->
        <div class="set-sec" id="layoutRow">
          <div class="set-sec-hd">
            <span class="set-sec-title" id="settingsLayoutLabel">B·ªë c·ª•c</span>
          </div>
          <div class="set-sec-body">
            <div class="set-pills">
              <button class="pill pill-wide active" id="btnLayout" aria-pressed="false">
                <span class="pill-icon">‚ò∞</span> X·∫øp d·ªçc
              </button>
              <button class="pill pill-wide" id="btnFullWidth" aria-pressed="false">
                <span class="pill-icon">‚õ∂</span> Full width
              </button>
            </div>
          </div>
        </div>

        <!-- ‚ë¢ C·ª† CH·ªÆ & GI√ÉN D√íNG -->
        <div class="set-sec">
          <div class="set-sec-hd">
            <span class="set-sec-title" id="settingsDisplayLabel">Hi·ªÉn th·ªã</span>
          </div>
          <div class="set-sec-body">
            <div class="slider-row">
              <div class="slider-label-row">
                <span class="set-mini-label" id="settingsFontSizeLabel">C·ª° ch·ªØ</span>
                <span class="slider-value-badge" id="zoomValueBadge">100%</span>
              </div>
              <div class="slider-track-wrap">
                <span class="slider-icon">A</span>
                <input type="range" class="sutra-slider" id="sliderZoom"
                       min="80" max="160" step="5" value="100"
                       aria-label="C·ª° ch·ªØ">
                <span class="slider-icon slider-icon-lg">A</span>
                <button class="slider-reset-btn" id="btnZoomReset" title="Reset" aria-label="Reset c·ª° ch·ªØ">‚Ü∫</button>
              </div>
            </div>
            <div class="slider-row">
              <div class="slider-label-row">
                <span class="set-mini-label" id="settingsLineHeightLabel">Gi√£n d√≤ng</span>
                <span class="slider-value-badge" id="lineHeightValueBadge">1.85</span>
              </div>
              <div class="slider-track-wrap">
                <span class="slider-icon">‚â°</span>
                <input type="range" class="sutra-slider" id="sliderLineHeight"
                       min="130" max="260" step="5" value="185"
                       aria-label="Gi√£n d√≤ng">
                <span class="slider-icon slider-icon-lg">‚ò∞</span>
                <button class="slider-reset-btn" id="btnLineHeightReset" title="Reset" aria-label="Reset gi√£n d√≤ng">‚Ü∫</button>
              </div>
            </div>
          </div>
        </div>

        <!-- ‚ë£ ƒê·ªåC KINH (TTS) -->
        <div class="set-sec" id="ttsSection">
          <div class="set-sec-hd">
            <span class="set-sec-title" id="settingsTtsTitle">ƒê·ªçc kinh</span>
            <span class="set-sec-sub" id="settingsTtsUiLabel">Text-to-Speech</span>
          </div>
          <div class="set-sec-body">
            <div class="tts-bar">
              <button class="tts-btn" id="btnReadTts"  title="Ph√°t" aria-label="Ph√°t TTS">‚ñ∂</button>
              <button class="tts-btn" id="btnPauseTts" title="T·∫°m d·ª´ng" aria-label="T·∫°m d·ª´ng TTS" disabled>‚è∏</button>
              <button class="tts-btn" id="btnStopTts"  title="D·ª´ng" aria-label="D·ª´ng TTS" disabled>‚èπ</button>
            </div>
            <div class="set-note" id="settingsTtsNote">Ch·ªçn ƒëo·∫°n kinh r·ªìi nh·∫•n ‚ñ∂ ƒë·ªÉ nghe ƒë·ªçc.</div>
          </div>
        </div>

      </div><!-- /.set-panel-body -->
    </div><!-- /#settingsPanel -->

  </div><!-- /#card -->
</div><!-- /.app -->

<!-- GUIDE OVERLAY -->
<div id="guideOverlay" role="dialog" aria-modal="true" aria-label="H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng"
     aria-hidden="true">
  <div class="guide-dialog"></div>
</div>

<!-- Scripts: toc.js must load BEFORE app.js so SUTRA_INDEX is available -->
<script src="toc.js"></script>
<script src="app.js"></script>
</body>
</html>
