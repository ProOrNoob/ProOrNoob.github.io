<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MN 131 â€“ Bhaddekaratta Sutta</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --muted:#64748b;
      --accent:#2563eb;
    }
    *{box-sizing:border-box}

    /* âœ… CHá»– NÃ€Y: cho html, body cao = 100% Ä‘á»ƒ Äƒn theo chiá»u cao iframe */
    html,body{
      margin:0;
      padding:0;
      height:100%;
      font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:#0f172a;
    }

    /* âœ… page-wrapper fill 100% iframe + flex Ä‘á»ƒ chia layout */
    .page-wrapper{
      height:100%;
      display:flex;
      justify-content:center;
      align-items:stretch;
      padding:7px; /* náº¿u muá»‘n cÃ³ viá»n trÃªn dÆ°á»›i thÃ¬ tÄƒng padding á»Ÿ Ä‘Ã¢y */
    }

    /* âœ… sutra-card chiáº¿m full chiá»u cao, chia header + thÃ¢n */
    .sutra-card{
      background:var(--card);
      border-radius:5px;
      border:1px solid #e6edf7;
      padding:5px;
      max-width:none;
      width:100%;
      margin:0 auto;
      display:flex;
      flex-direction:column;
    }

    .sutra-header{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:0.5rem;
      margin-bottom:0.35rem;
      flex:0 0 auto;
    }

    .sutra-title{
      font-size:1rem;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:.04em;
      color:var(--accent);
      margin:0;
    }

    .controls .btn{
      min-width:90px;
      height:32px;
      padding:0 .6rem;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:13px;
      border-radius:8px;
      white-space:nowrap;
    }

    /* âœ… sutra-grid chiáº¿m toÃ n bá»™ pháº§n cÃ²n láº¡i, scroll bÃªn trong
       KHÃ”NG dÃ¹ng 100vh ná»¯a */
    .sutra-grid{
      display:flex;
      flex-direction:column;
      gap:8px;
      flex:1 1 auto;
      overflow:auto;
    }

    .sutra-row{
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
      padding:10px;
      border-radius:8px;
    }
    .sutra-row:nth-child(odd){
      background:rgba(37,99,235,0.03);
    }

    .sutra-col{
      min-height:1px;
      padding:6px;
      border-radius:6px;
    }

    .pali{font-family:"Noto Serif",serif;font-size:15px;line-height:1.6}
    .eng{font-family:Georgia,serif;font-size:14px;line-height:1.6}
    .vie{font-family:system-ui;font-size:14px;line-height:1.6}
    .col-head{font-weight:600;color:var(--muted);font-size:13px;margin-bottom:4px}

    .hide-pali .pali-col{display:none;}
    .hide-eng  .eng-col {display:none;}
    .hide-vie  .vie-col {display:none;}

    .stack .sutra-row{grid-template-columns:1fr;}

    /* overlay color */
    .overlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:2000;
    }
    .overlay.show{display:flex;}
    .dialog{
      background:var(--card);
      border-radius:12px;
      padding:14px 18px;
      max-width:640px;
      width:90%;
      box-shadow:0 18px 45px rgba(15,23,42,0.35);
    }
    .dialog-close{
      border:none;
      background:transparent;
      font-size:20px;
      line-height:1;
      cursor:pointer;
      color:#64748b;
      padding-left:8px;
    }
    .dialog-close:hover{color:#0f172a;}

    .tab-btn.active{
      background-color:var(--accent);
      color:#fff !important;
    }

    .dialog .btn{
      min-width:110px;
      text-align:center;
    }

    @media(max-width:768px){
      .sutra-row{grid-template-columns:1fr;}
      .controls .btn{min-width:80px;}
    }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <div class="sutra-card">
      <!-- HEADER TRONG TRANG KINH -->
      <div class="sutra-header">
        <div>
          <h1 id="sutraTitleLocal" class="sutra-title">
            MN 131 â€“ BHADDEKARATTA SUTTA
          </h1>
          <div id="sutraSubtitle" class="text-muted small">
            The Discourse on a Single Excellent Night
          </div>
        </div>

        <div class="controls d-flex flex-wrap align-items-center gap-2">
          <div class="btn-group btn-group-sm" role="group" aria-label="Languages">
            <button type="button" class="btn btn-outline-secondary active" id="btnPali">PÄli</button>
            <button type="button" class="btn btn-outline-secondary active" id="btnEng">English</button>
            <button type="button" class="btn btn-outline-secondary active" id="btnVie">Vietnamese</button>
          </div>
          <button id="btnLayout" class="btn btn-outline-secondary btn-sm" type="button">
            Row
          </button>
          <button id="btnColor" class="btn btn-outline-secondary btn-sm" type="button">
            ğŸ¨ Color
          </button>
        </div>
      </div>

      <!-- Ná»˜I DUNG KINH -->
      <div id="sutraGrid" class="sutra-grid">
        <!-- Row 1 -->
        <div class="sutra-row" data-idx="1">
          <div class="sutra-col pali-col">
            <div class="col-head">PÄli</div>
            <div class="pali">
              Evaá¹ me sutaá¹: Ekaá¹ samayaá¹ bhagavÄ sÄvatthiyaá¹ vihÄrati jetavane anÄthapiá¹‡á¸ikassa ÄrÄme.
            </div>
          </div>
          <div class="sutra-col eng-col">
            <div class="col-head">English</div>
            <div class="eng">
              Thus have I heard: At one time the Blessed One was dwelling at SÄvatthÄ«, in Jeta's Grove, AnÄthapiá¹‡á¸ika's Park.
            </div>
          </div>
          <div class="sutra-col vie-col">
            <div class="col-head">Tiáº¿ng Viá»‡t</div>
            <div class="vie">
              Nghe nhÆ° váº§y: CÃ³ má»™t thá»i, Tháº¿ TÃ´n trÃº táº¡i XÃ¡-vá»‡, trong rá»«ng Ká»³-Ä‘Ã , táº¡i khu vÆ°á»n cá»§a AnÄthapiá¹‡á¸ika.
            </div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="sutra-row" data-idx="2">
          <div class="sutra-col pali-col">
            <div class="pali">
              Tatra kho bhagavÄ bhikkhÅ« Ämantesi: â€œBhikkhavoâ€ti. â€œBhaddanteâ€ti te bhikkhÅ« bhagavato paccassosuá¹.
            </div>
          </div>
          <div class="sutra-col eng-col">
            <div class="eng">
              There the Blessed One addressed the bhikkhus: â€œBhikkhus!â€ â€œVenerable sir,â€ the bhikkhus replied to the Blessed One.
            </div>
          </div>
          <div class="sutra-col vie-col">
            <div class="vie">
              á» Ä‘Ã³ Tháº¿ TÃ´n nÃ³i vá»›i cÃ¡c tá»³-kheo: â€œNÃ y cÃ¡c tá»³-kheo.â€ â€œBáº¡ch trÆ°á»Ÿng lÃ£o,â€ cÃ¡c tá»³-kheo tráº£ lá»i Äá»©c Pháº­t.
            </div>
          </div>
        </div>

        <!-- Row 3 -->
        <div class="sutra-row" data-idx="3">
          <div class="sutra-col pali-col">
            <div class="pali">
              AtÄ«taá¹ nÄnvÄgameyya, nappaá¹­ikaá¹…khe anÄgataá¹; yadatÄ«taá¹ pahÄ«naá¹ taá¹, appattaÃ±ca anÄgataá¹.
            </div>
          </div>
          <div class="sutra-col eng-col">
            <div class="eng">
              Let the past not be clung to; the future not expected; whatever is past has been left behind, and the future is not yet come.
            </div>
          </div>
          <div class="sutra-col vie-col">
            <div class="vie">
              Äá»«ng bÃ¡m vÃ­u vÃ o quÃ¡ khá»©, Ä‘á»«ng mong chá» tÆ°Æ¡ng lai; Ä‘iá»u Ä‘Ã£ qua Ä‘Ã£ bá», Ä‘iá»u tÆ°Æ¡ng lai chÆ°a Ä‘áº¿n.
            </div>
          </div>
        </div>

        <!-- Row 4 -->
        <div class="sutra-row" data-idx="4">
          <div class="sutra-col pali-col">
            <div class="pali">
              Idamavoca bhagavÄ. AttamanÄ te bhikkhÅ« bhagavato bhÄsitaá¹ abhinandunti. Bhaddekarattasuttaá¹ niá¹­á¹­hitaá¹.
            </div>
          </div>
          <div class="sutra-col eng-col">
            <div class="eng">
              Thus the Blessed One spoke. The bhikkhus were glad and praised what had been said by the Blessed One. The Bhaddekaratta Sutta is concluded.
            </div>
          </div>
          <div class="sutra-col vie-col">
            <div class="vie">
              Äá»©c Pháº­t thuyáº¿t xong. CÃ¡c tá»³-kheo hoan há»· vÃ  tÃ¡n thÃ¡n lá»i Pháº­t dáº¡y. Kinh Bhaddekaratta káº¿t thÃºc.
            </div>
          </div>
        </div>
      </div>

      <p id="hintText" class="text-muted small mt-2 mb-0">
        Use PÄli / English / Vietnamese buttons to toggle columns; "Row" / "Col" switches layout; "Color" customizes text/background colors per language (saved in localStorage).
      </p>
    </div>
  </div>

  <!-- COLOR OVERLAY -->
  <div id="colorOverlay" class="overlay" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h2 id="colorTitle" class="mb-0">ğŸ¨ Color settings</h2>
        <div class="d-flex align-items-center gap-2">
          <div class="btn-group btn-group-sm" role="tablist">
            <button type="button" class="btn btn-outline-secondary tab-btn active" id="tabPali">
              PÄli
            </button>
            <button type="button" class="btn btn-outline-secondary tab-btn" id="tabEng">
              English
            </button>
            <button type="button" class="btn btn-outline-secondary tab-btn" id="tabVie">
              Vietnamese
            </button>
          </div>
          <button type="button" class="dialog-close" id="colorClose">Ã—</button>
        </div>
      </div>

      <!-- PÄli -->
      <div id="colorContentPali">
        <p class="mb-2"><strong>PÄli</strong> â€“ chá»‰nh mÃ u cho cá»™t PÄli.</p>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>MÃ u chá»¯</span>
          <input id="paliColor" type="color" title="MÃ u chá»¯ PÄli" value="#0f172a">
        </div>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>MÃ u ná»n</span>
          <input id="paliBg" type="color" title="MÃ u ná»n PÄli" value="#ffffff">
        </div>
        <div class="text-end mt-2">
          <button class="btn btn-outline-secondary btn-sm" type="button" id="resetPali">Reset PÄli</button>
        </div>
      </div>

      <!-- English -->
      <div id="colorContentEng" class="d-none">
        <p class="mb-2"><strong>English</strong> â€“ color settings for the English column.</p>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>Text color</span>
          <input id="engColor" type="color" title="English text color" value="#0f172a">
        </div>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>Background</span>
          <input id="engBg" type="color" title="English background color" value="#ffffff">
        </div>
        <div class="text-end mt-2">
          <button class="btn btn-outline-secondary btn-sm" type="button" id="resetEng">Reset English</button>
        </div>
      </div>

      <!-- Vietnamese -->
      <div id="colorContentVie" class="d-none">
        <p class="mb-2"><strong>Tiáº¿ng Viá»‡t</strong> â€“ chá»‰nh mÃ u cho cá»™t tiáº¿ng Viá»‡t.</p>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>MÃ u chá»¯</span>
          <input id="vieColor" type="color" title="MÃ u chá»¯ Tiáº¿ng Viá»‡t" value="#0f172a">
        </div>
        <div class="mb-2 d-flex justify-content-between align-items-center">
          <span>MÃ u ná»n</span>
          <input id="vieBg" type="color" title="MÃ u ná»n Tiáº¿ng Viá»‡t" value="#ffffff">
        </div>
        <div class="text-end mt-2">
          <button class="btn btn-outline-secondary btn-sm" type="button" id="resetVie">Reset Tiáº¿ng Viá»‡t</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const grid        = document.getElementById('sutraGrid');
      const card        = document.querySelector('.sutra-card');
      const btnPali     = document.getElementById('btnPali');
      const btnEng      = document.getElementById('btnEng');
      const btnVie      = document.getElementById('btnVie');
      const btnLayout   = document.getElementById('btnLayout');
      const btnColor    = document.getElementById('btnColor');

      const paliCols    = document.querySelectorAll('.pali-col');
      const engCols     = document.querySelectorAll('.eng-col');
      const vieCols     = document.querySelectorAll('.vie-col');

      const colorOverlay   = document.getElementById('colorOverlay');
      const colorClose     = document.getElementById('colorClose');
      const tabPali        = document.getElementById('tabPali');
      const tabEng         = document.getElementById('tabEng');
      const tabVie         = document.getElementById('tabVie');
      const colorContentPali = document.getElementById('colorContentPali');
      const colorContentEng  = document.getElementById('colorContentEng');
      const colorContentVie  = document.getElementById('colorContentVie');

      const paliBgInput    = document.getElementById('paliBg');
      const paliColorInput = document.getElementById('paliColor');
      const engBgInput     = document.getElementById('engBg');
      const engColorInput  = document.getElementById('engColor');
      const vieBgInput     = document.getElementById('vieBg');
      const vieColorInput  = document.getElementById('vieColor');

      const resetPaliBtn = document.getElementById('resetPali');
      const resetEngBtn  = document.getElementById('resetEng');
      const resetVieBtn  = document.getElementById('resetVie');

      const hintText   = document.getElementById('hintText');
      const subTitle   = document.getElementById('sutraSubtitle');

      let showPali = true;
      let showEng  = true;
      let showVie  = true;

      function applyUiLang(){
        let lang = 'vi';
        try{
          const v = localStorage.getItem('nikaya_lang');
          if(v === 'en' || v === 'vi') lang = v;
        }catch(e){}

        if(lang === 'en'){
          btnPali.textContent = 'PÄli';
          btnEng.textContent  = 'English';
          btnVie.textContent  = 'Vietnamese';
          btnLayout.textContent = card.classList.contains('stack') ? 'Col' : 'Row';
          btnColor.textContent  = 'ğŸ¨ Color';
          hintText.textContent =
            'Use PÄli / English / Vietnamese buttons to toggle columns; "Row" / "Col" switches between multi-column and stacked layout; "Color" customizes text/background colors per language (saved in localStorage).';
          subTitle.textContent = 'The Discourse on a Single Excellent Night';
        }else{
          btnPali.textContent = 'PÄli';
          btnEng.textContent  = 'English';
          btnVie.textContent  = 'Tiáº¿ng Viá»‡t';
          btnLayout.textContent = card.classList.contains('stack') ? 'Col' : 'Row';
          btnColor.textContent  = 'ğŸ¨ MÃ u';
          hintText.textContent =
            'DÃ¹ng cÃ¡c nÃºt PÄli / English / Tiáº¿ng Viá»‡t Ä‘á»ƒ áº©n/hiá»‡n cá»™t; "Row" chuyá»ƒn giá»¯a nhiá»u cá»™t vÃ  xáº¿p chá»“ng "Col"; "MÃ u" Ä‘á»ƒ chá»‰nh mÃ u chá»¯/ná»n riÃªng cho tá»«ng ngÃ´n ngá»¯ (lÆ°u báº±ng localStorage).';
          subTitle.textContent = 'Kinh Nháº¥t Dáº¡ Hiá»n Giáº£';
        }
      }

      function adjustRowColumns(){
        const rows = grid.querySelectorAll('.sutra-row');
        rows.forEach(row=>{
          if(card.classList.contains('stack')){
            row.style.gridTemplateColumns = '1fr';
            return;
          }
          const cols = Array.from(row.querySelectorAll('.sutra-col'));
          const visible = cols.filter(col=>{
            if(col.classList.contains('pali-col') && !showPali) return false;
            if(col.classList.contains('eng-col')  && !showEng)  return false;
            if(col.classList.contains('vie-col')  && !showVie)  return false;
            return true;
          });
          const n = Math.max(1, visible.length);
          row.style.gridTemplateColumns = `repeat(${n},1fr)`;
        });
      }

      function updateVisibility(){
        grid.classList.toggle('hide-pali', !showPali);
        grid.classList.toggle('hide-eng',  !showEng);
        grid.classList.toggle('hide-vie',  !showVie);
        adjustRowColumns();
      }

      btnPali.addEventListener('click',()=>{
        showPali = !showPali;
        btnPali.classList.toggle('active', showPali);
        updateVisibility();
      });
      btnEng.addEventListener('click',()=>{
        showEng = !showEng;
        btnEng.classList.toggle('active', showEng);
        updateVisibility();
      });
      btnVie.addEventListener('click',()=>{
        showVie = !showVie;
        btnVie.classList.toggle('active', showVie);
        updateVisibility();
      });

      btnLayout.addEventListener('click',()=>{
        card.classList.toggle('stack');
        const isStack = card.classList.contains('stack');
        btnLayout.textContent = isStack ? 'Col' : 'Row';
        applyUiLang();
        adjustRowColumns();
      });

      function setColorTab(lang){
        const isPali = lang === 'pali';
        const isEng  = lang === 'eng';
        const isVie  = lang === 'vie';

        tabPali.classList.toggle('active', isPali);
        tabEng.classList.toggle('active',  isEng);
        tabVie.classList.toggle('active',  isVie);

        colorContentPali.classList.toggle('d-none', !isPali);
        colorContentEng.classList.toggle('d-none',  !isEng);
        colorContentVie.classList.toggle('d-none',  !isVie);
      }
      function openColor(){
        colorOverlay.classList.add('show');
        colorOverlay.setAttribute('aria-hidden','false');
      }
      function closeColor(){
        colorOverlay.classList.remove('show');
        colorOverlay.setAttribute('aria-hidden','true');
      }
      btnColor.addEventListener('click',(e)=>{ e.stopPropagation(); openColor(); });
      colorClose.addEventListener('click',(e)=>{ e.stopPropagation(); closeColor(); });
      colorOverlay.addEventListener('click',(e)=>{ if(e.target===colorOverlay) closeColor(); });

      tabPali.addEventListener('click',(e)=>{ e.stopPropagation(); setColorTab('pali'); });
      tabEng.addEventListener('click',(e)=>{ e.stopPropagation(); setColorTab('eng'); });
      tabVie.addEventListener('click',(e)=>{ e.stopPropagation(); setColorTab('vie'); });

      function loadColors(){
        let saved = {};
        try{
          saved = JSON.parse(localStorage.getItem('bh_colors') || '{}');
        }catch(e){ saved = {}; }

        paliCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});
        engCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});
        vieCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});

        paliBgInput.value    = saved.paliBg    || '#ffffff';
        paliColorInput.value = saved.paliColor || '#0f172a';
        engBgInput.value     = saved.engBg     || '#ffffff';
        engColorInput.value  = saved.engColor  || '#0f172a';
        vieBgInput.value     = saved.vieBg     || '#ffffff';
        vieColorInput.value  = saved.vieColor  || '#0f172a';

        if(saved.paliBg)    paliCols.forEach(c=>c.style.background=saved.paliBg);
        if(saved.paliColor) paliCols.forEach(c=>c.style.color=saved.paliColor);
        if(saved.engBg)     engCols.forEach(c=>c.style.background=saved.engBg);
        if(saved.engColor)  engCols.forEach(c=>c.style.color=saved.engColor);
        if(saved.vieBg)     vieCols.forEach(c=>c.style.background=saved.vieBg);
        if(saved.vieColor)  vieCols.forEach(c=>c.style.color=saved.vieColor);
      }

      function saveColors(){
        const obj = {
          paliBg: paliBgInput.value || '#ffffff',
          paliColor: paliColorInput.value || '#0f172a',
          engBg: engBgInput.value || '#ffffff',
          engColor: engColorInput.value || '#0f172a',
          vieBg: vieBgInput.value || '#ffffff',
          vieColor: vieColorInput.value || '#0f172a'
        };
        try{
          localStorage.setItem('bh_colors', JSON.stringify(obj));
        }catch(e){}
      }

      paliBgInput.addEventListener('input', e=>{
        paliCols.forEach(c=>c.style.background=e.target.value);
        saveColors();
      });
      paliColorInput.addEventListener('input', e=>{
        paliCols.forEach(c=>c.style.color=e.target.value);
        saveColors();
      });

      engBgInput.addEventListener('input', e=>{
        engCols.forEach(c=>c.style.background=e.target.value);
        saveColors();
      });
      engColorInput.addEventListener('input', e=>{
        engCols.forEach(c=>c.style.color=e.target.value);
        saveColors();
      });

      vieBgInput.addEventListener('input', e=>{
        vieCols.forEach(c=>c.style.background=e.target.value);
        saveColors();
      });
      vieColorInput.addEventListener('input', e=>{
        vieCols.forEach(c=>c.style.color=e.target.value);
        saveColors();
      });

      resetPaliBtn.addEventListener('click',()=>{
        paliCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});
        paliBgInput.value    = '#ffffff';
        paliColorInput.value = '#0f172a';
        saveColors();
      });
      resetEngBtn.addEventListener('click',()=>{
        engCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});
        engBgInput.value     = '#ffffff';
        engColorInput.value  = '#0f172a';
        saveColors();
      });
      resetVieBtn.addEventListener('click',()=>{
        vieCols.forEach(c=>{c.style.background='#ffffff';c.style.color='#0f172a';});
        vieBgInput.value     = '#ffffff';
        vieColorInput.value  = '#0f172a';
        saveColors();
      });

      setColorTab('pali');
      loadColors();
      updateVisibility();
      applyUiLang();
    })();
  </script>
</body>
</html>
